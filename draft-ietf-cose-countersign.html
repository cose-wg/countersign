<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>CBOR Object Signing and Encryption (COSE): Countersignatures</title>
<meta content="Jim Schaad" name="author">
<meta content="Russ Housley" name="author">
<meta content="
       
        Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size.
        CBOR Object Signing and Encryption (COSE) defines a set of security services for CBOR.
        This document defines a countersignature algorithm along with the needed header parameters and CBOR tags for COSE.
       
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="draft-ietf-cose-countersign-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.8.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 51.3.3
    six 1.15.0
-->
<link href="draft-ietf-cose-countersign.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  scrollbar-color: #bbb #eee;
}
@media (prefers-color-scheme: dark) {
html {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
#title, #rfcnum {
  margin: 1.5em 0 0.2em;
}
#rfcnum + #title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">COSE Structure</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schaad &amp; Housley</td>
<td class="center">Expires 20 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">COSE Working Group</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://datatracker.ietf.org/doc/html/rfc8152" class="eref">8152</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-19" class="published">19 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-20">20 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Schaad</div>
<div class="org">August Cellars</div>
</div>
<div class="author">
      <div class="author-name">R. Housley, <span class="editor">Ed.</span>
</div>
<div class="org">Vigil Security</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">CBOR Object Signing and Encryption (COSE): Countersignatures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size.
        CBOR Object Signing and Encryption (COSE) defines a set of security services for CBOR.
        This document defines a countersignature algorithm along with the needed header parameters and CBOR tags for COSE.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-contributing-to-this-docume">
<a href="#name-contributing-to-this-docume" class="section-name selfRef">Contributing to this document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The source for this draft is being maintained in GitHub.
        Suggested changes should be submitted as pull requests  at <span><a href="https://github.com/cose-wg/countersign">https://github.com/cose-wg/countersign</a></span>.
        Instructions are on that page as well.
        Editorial changes can be managed in GitHub, but any substantial issues need to be discussed on the COSE mailing list.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-terminology" class="xref">Requirements Terminology</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-cbor-grammar" class="xref">CBOR Grammar</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-document-terminology" class="xref">Document Terminology</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-countersignature-header-par" class="xref">Countersignature Header Parameters</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-version-2-countersignatures" class="xref">Version 2 Countersignatures</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-full-countersignatures" class="xref">Full Countersignatures</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-abbreviated-countersignatur" class="xref">Abbreviated Countersignatures</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-signing-and-verification-pr" class="xref">Signing and Verification Process</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-cbor-encoding-restrictions" class="xref">CBOR Encoding Restrictions</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-cbor-tag-assignment" class="xref">CBOR Tag Assignment</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-cose-header-parameters-regi" class="xref">COSE Header Parameters Registry</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-authors-versions" class="xref">Author's Versions</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-cose-testing-library" class="xref">COSE Testing Library</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-examples" class="xref">Examples</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-use-of-early-code-points" class="xref">Use of Early Code Points</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-examples-of-signed-messages" class="xref">Examples of Signed Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-a.2.1" class="xref">A.2.1</a>.  <a href="#name-countersignature" class="xref">Countersignature</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-examples-of-signed1-message" class="xref">Examples of Signed1 Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-a.3.1" class="xref">A.3.1</a>.  <a href="#name-countersignature-2" class="xref">Countersignature</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-examples-of-enveloped-messa" class="xref">Examples of Enveloped Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-a.4.1" class="xref">A.4.1</a>.  <a href="#name-countersignature-on-encrypt" class="xref">Countersignature on Encrypted Content</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-examples-of-encrypted-messa" class="xref">Examples of Encrypted Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.5.2.1">
                    <p id="section-toc.1-1.9.2.5.2.1.1"><a href="#section-a.5.1" class="xref">A.5.1</a>.  <a href="#name-countersignature-on-encrypte" class="xref">Countersignature on Encrypted Content</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-a.6" class="xref">A.6</a>.  <a href="#name-examples-of-maced-messages" class="xref">Examples of MACed Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.6.2.1">
                    <p id="section-toc.1-1.9.2.6.2.1.1"><a href="#section-a.6.1" class="xref">A.6.1</a>.  <a href="#name-countersignature-on-mac-con" class="xref">Countersignature on MAC Content</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-a.7" class="xref">A.7</a>.  <a href="#name-examples-of-mac0-messages" class="xref">Examples of MAC0 Messages</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.7.2.1">
                    <p id="section-toc.1-1.9.2.7.2.1.1"><a href="#section-a.7.1" class="xref">A.7.1</a>.  <a href="#name-countersignature-on-mac0-co" class="xref">Countersignature on MAC0 Content</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        There has been an increased focus on small, constrained devices that make up the Internet of Things (IoT). 
        One of the standards that has come out of this process is "Concise Binary Object Representation (CBOR)" <span>[<a href="#I-D.ietf-cbor-7049bis" class="xref">I-D.ietf-cbor-7049bis</a>]</span>. 
        CBOR extended the data model of the JavaScript Object Notation (JSON) <span>[<a href="#STD90" class="xref">STD90</a>]</span> by allowing for binary data, among other changes. 
        CBOR has been adopted by several of the IETF working groups dealing with the IoT world as their encoding of data structures. 
        CBOR was designed specifically both to be small in terms of messages transported and implementation size and to be a schema-free decoder. 
        A need exists to provide message security services for IoT, and using CBOR as the message-encoding format makes sense.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        During the process of advancing COSE to an Internet Standard, it was noticed the description of the security properties of countersignatures was incorrect for the COSE_Sign1 structure.
        Since the security properties that were described, those of a true countersignature, were those that the working group desired, the decision was made to remove all of the countersignature text from <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span> and create a new document to both deprecate the old countersignature algorithm and to define a new one with the desired security properties.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
        The problem with the previous countersignature algorithm was that the cryptographically computed value was not always included.
        The initial assumption that the cryptographic value was in the third slot of the array was known not to be true at the time, but in the case of the MAC structures this was not deemed to be an issue.
        The new algorithm is more aggressive about the set of values included in the countersignature computation so that the cryptographic computed values is included.
        The exception to this is the COSE_Signature structure where there is no cryptographic computed value.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
        The new algorithm is designed to produce the same countersignature value in those cases where the cryptographic computed value was already included.
        This means that for those structures the only thing that would need to be done is to change the value of the header parameter.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="requirements-terminology">
<section id="section-1.1">
        <h3 id="name-requirements-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-terminology" class="section-name selfRef">Requirements Terminology</a>
        </h3>
<p id="section-1.1-1">
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cbor-grammar">
<section id="section-1.2">
        <h3 id="name-cbor-grammar">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-cbor-grammar" class="section-name selfRef">CBOR Grammar</a>
        </h3>
<p id="section-1.2-1">
          CBOR grammar in the document is presented using CBOR Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">The collected CDDL can be extracted from the XML version of this document via the following XPath expression below.  (Depending on the XPath evaluator one is using, it may be necessary to deal with &amp;gt; as an entity.)<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div id="section-1.2-3">
<pre class="sourcecode lang-XPATH">
//sourcecode[@type='CDDL']/text()
</pre><a href="#section-1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-1.2-4">CDDL expects the initial non-terminal symbol to be the first symbol in the file.  For this reason, the first fragment of CDDL is presented here.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<div id="section-1.2-5">
<pre class="sourcecode lang-CDDL">
start = COSE_Countersignature_Tagged / Internal_Types

; This is defined to make the tool quieter:
Internal_Types = Countersign_structure / COSE_Countersignature0
</pre><a href="#section-1.2-5" class="pilcrow">¶</a>
</div>
<p id="section-1.2-6">The non-terminal Internal_Types is defined for dealing with the automated validation tools used during the writing of this document.  It references those non-terminals that are used for security computations but are not emitted for transport.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-1.3">
        <h3 id="name-document-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-document-terminology" class="section-name selfRef">Document Terminology</a>
        </h3>
<p id="section-1.3-1">In this document, we use the following terminology:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Byte is a synonym for octet.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">
          Constrained Application Protocol (CoAP) is a specialized web transfer protocol for use in constrained systems.  It is defined in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">
          Context is used throughout the document to represent information that is not part of the COSE message.
          Information which is part of the context can come from several different sources including:
          Protocol interactions, associated key structures, and program configuration.
          The context to use can be implicit, identified using the 'kid context' header parameter defined in <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, or identified by a protocol-specific identifier.
          Context should generally be included in the cryptographic construction; for more details see <span><a href="https://tools.ietf.org/html/draft-ietf-cose-rfc8152bis-struct-15#section-4.3" class="relref">Section 4.3</a> of [<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span>.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">The term 'byte string' is used for sequences of bytes, while the term 'text string' is used for sequences of characters.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-countersignature-header-par">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-countersignature-header-par" class="section-name selfRef">Countersignature Header Parameters</a>
      </h2>
<p id="section-2-1">This section defines a set of common header parameters.  A summary of these header parameters can be found in <a href="#Header-Table" class="xref">Table 1</a>.  This table should be consulted to determine the value of label and the type of the value.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The set of header parameters defined in this section are:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">V2 countersignature:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          This header parameter holds one or more countersignature values. 
          Countersignatures provide a method of having a second party sign some data. 
          The countersignature header parameter can occur as an unprotected attribute in any of the following structures: COSE_Sign1, COSE_Signature, COSE_Encrypt, COSE_recipient, COSE_Encrypt0, COSE_Mac, and COSE_Mac0. 
          Details on version 2 countersignatures are found in <a href="#counter_signatureV2" class="xref">Section 3</a>.<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<span id="name-common-header-parameters"></span><div id="Header-Table">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-common-header-parameters" class="selfRef">Common Header Parameters</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Label</th>
            <th class="text-left" rowspan="1" colspan="1">Value Type</th>
            <th class="text-left" rowspan="1" colspan="1">Value Registry</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">counter signature version 2</td>
            <td class="text-left" rowspan="1" colspan="1">TBD10</td>
            <td class="text-left" rowspan="1" colspan="1">COSE_Countersignature / [+ COSE_Countersignature ]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">V2 counter signature attribute</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">counter signature 0 version 2</td>
            <td class="text-left" rowspan="1" colspan="1">TBD11</td>
            <td class="text-left" rowspan="1" colspan="1">COSE_Countersignature0</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">Abbreviated Counter signature vesion 2</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-2-5">The CDDL fragment that represents the set of header parameters defined in this section is given below.  Each of the header parameters is tagged as optional because they do not need to be in every map; header parameters required in specific maps are discussed above.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="section-2-6">
<pre class="sourcecode lang-CDDL">
      Generic_Headers /= (
      ? TBD10 =&gt; COSE_Countersignature / [+COSE_Countersignature]
      ; V2 Countersignature
      ? TBD11 =&gt; COSE_Countersignature0  ; V2 Countersignature0
      )
</pre><a href="#section-2-6" class="pilcrow">¶</a>
</div>
</section>
<div id="counter_signatureV2">
<section id="section-3">
      <h2 id="name-version-2-countersignatures">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-version-2-countersignatures" class="section-name selfRef">Version 2 Countersignatures</a>
      </h2>
<p id="section-3-1">
        A countersignature is normally defined as a second signature that confirms a primary signature.
        A normal example of a countersignature is the signature that a notary public places on a document as witnessing that you have signed the document.
        Thus applying a countersignature to either the COSE_Signature or COSE_Sign1 objects match this traditional definition.
        This document extends the context of a countersignature to allow it to be applied to all of the security structures defined.
        It needs to be noted that the countersignature needs to be treated as a separate operation from the initial operation even if it is applied by the same user as is done in <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
        COSE supports two different forms for countersignatures.
        Full countersignatures use the structure COSE_Countersignature.
        This is same structure as COSE_Signature and thus it can have protected and unprotected attributes, including chained countersignatures.
        Abbreviated countersignatures use the structure COSE_Countersignature0.
        This structure only contains the signature value and nothing else.
        The structures cannot be converted between each other; as the signature computation includes a parameter identifying which structure is being used, the converted structure will fail signature validation.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
        The version 2 countersignature changes the algorithm used for computing the signature from the original version <span><a href="https://rfc-editor.org/rfc/rfc8152#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8152" class="xref">RFC8152</a>]</span>.
        The new version now includes the cryptographic material generated for all of the structures rather than just for a subset.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
        COSE was designed for uniformity in how the data structures are specified.
        One result of this is that for COSE one can expand the concept of countersignatures beyond just the idea of signing a signature to being able to sign most of the structures without having to create a new signing layer.
        When creating a countersignature, one needs to be clear about the security properties that result.
        When done on a COSE_Signature or COSE_Sign1, the normal countersignature semantics are preserved.
        That is the countersignature makes a statement about the existence of a signature and, when used as a timestamp, a time point at which the signature exists.
        When done on a COSE_Sign, this is the same as applying a second signature to the payload and adding a parallel signature as a new COSE_Signature is the preferred method.
        When done on a COSE_Mac or COSE_Mac0, the payload is included as well as the MAC value.
        When done on a COSE_Encrypt or COSE_Encrypt0, the existence of the encrypted data is attested to.
        It should be noted that there is a big difference between attesting to the encrypted data as opposed to attesting to the unencrypted data.
        If the latter is what is desired, then one needs to apply a signature to the data and then encrypt that.
        It is always possible to construct cases where the use of two different keys will appear to result in a successful decryption (the tag check success), but which produce two completely different plaintexts.
        This situation is not detectable by a countersignature on the encrypted data.<a href="#section-3-4" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-full-countersignatures">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-full-countersignatures" class="section-name selfRef">Full Countersignatures</a>
        </h3>
<p id="section-3.1-1">
          The COSE_Countersignature structure allows for the same set of capabilities  as a COSE_Signature.
          This means that all of the capabilities of a signature are duplicated with this structure.
          Specifically, the countersigner does not need to be related to the producer of what is being countersigned as key and algorithm identification can be placed in the countersignature attributes.
          This also means that the countersignature can itself be countersigned.
          This is a feature required by protocols such as long-term archiving services.
          More information on how countersignatures is used can be found in the evidence record syntax described in <span>[<a href="#RFC4998" class="xref">RFC4998</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
          The full countersignature structure can be encoded as either tagged or untagged depending on the context it is used in.  A tagged COSE_Countersignature structure is identified by the CBOR tag TBD0.  The countersignature structure is the same as that used for a signer on a signed object. The CDDL fragment for full countersignatures is:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div id="section-3.1-3">
<pre class="sourcecode lang-CDDL">
COSE_Countersignature_Tagged = #6.9999(COSE_Countersignature)
COSE_Countersignature = COSE_Signature
</pre><a href="#section-3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1-4">
          The details of the fields of a countersignature can be found in <span><a href="https://tools.ietf.org/html/draft-ietf-cose-rfc8152bis-struct-15#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">          
          An example of a countersignature on a signature can be found in <a href="#Appendix_A_1_1" class="xref">Appendix A.2.1</a>. 
          An example of a countersignature in an encryption object can be found in <a href="#Appendix_A_2_1" class="xref">Appendix A.4.1</a>.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">
          It should be noted that only a signature algorithm with appendix (see <span><a href="https://tools.ietf.org/html/draft-ietf-cose-rfc8152bis-struct-15#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span>) can be used for countersignatures. 
          This is because the body should be able to be processed without having to evaluate the countersignature, and this is not possible for signature schemes with message recovery.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-abbreviated-countersignatur">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-abbreviated-countersignatur" class="section-name selfRef">Abbreviated Countersignatures</a>
        </h3>
<p id="section-3.2-1">
          Abbreviated countersignatures were designed primarily to deal with the problem of encrypted group messaging, but where it is required to know who originated the message.
          The objective was to keep the countersignature as small as possible while still providing the needed security.
          For abbreviated countersignatures, there is no provision for any protected attributes related to the signing operation.
          Instead, the parameters for computing or verifying the abbreviated countersignature are provided by the same context used to describe the encryption, signature, or MAC processing.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
          The CDDL fragment for the abbreviated countersignatures is:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="section-3.2-3">
<pre class="sourcecode lang-CDDL">
COSE_Countersignature0 = bstr
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">
          The byte string representing the signature value is placed in the Countersignature0 attribute.
          This attribute is then encoded as an unprotected header parameter.
          The attribute is defined below.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
<div id="CountersignV2_verify">
<section id="section-3.3">
        <h3 id="name-signing-and-verification-pr">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-signing-and-verification-pr" class="section-name selfRef">Signing and Verification Process</a>
        </h3>
<p id="section-3.3-1">
          In order to create a signature, a well-defined byte string is needed.
          The Countersign_structure is used to create the canonical form. 
          This signing and verification process takes in countersignature target structure, the signer information (COSE_Signature), and the application data (external source). 
          A Countersign_structure is a CBOR array.
          The target structure of the countersignature needs to have all of it's cryptographic functions finalized before the computing the signature.
          The fields of the Countersign_structure in order are:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-2">
          <li id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">
              A context text string identifying the context of the signature.  The context text string is:<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.3-2.1.2.1">
                "CounterSignature" for signatures using the COSE_Countersignature structure when other_fields is absent.<a href="#section-3.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-3.3-2.1.2.2">
                "CounterSignature0" for signatures using the COSE_Countersignature0 structure when other_fields is absent.<a href="#section-3.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-3.3-2.1.2.3">
                "CounterSignatureV2" for signatures using the COSE_Countersignature structure when other_fields is present.<a href="#section-3.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-3.3-2.1.2.4">
                "CounterSignature0V2" for signatures using the COSE_Countersignature0 structure when other_fields is present.<a href="#section-3.3-2.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.3-2.2">
            The protected attributes from the target structure encoded in a bstr type.
            If there are no protected attributes, a zero-length byte string is used.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.3">
            The protected attributes from the signer structure encoded in a bstr type.
            If there are no protected attributes, a zero-length byte string is used. 
            This field is omitted for the Countersignature0V2 attribute.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.4">
            The externally supplied data from the application encoded in a bstr type.
            If this field is not supplied, it defaults to a zero-length byte string.
            (See <span><a href="https://tools.ietf.org/html/draft-ietf-cose-rfc8152bis-struct-15#section-4.3" class="relref">Section 4.3</a> of [<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span> for application guidance on constructing this field.)<a href="#section-3.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.5">
            The payload to be signed encoded in a bstr type.
            The payload is placed here independent of how it is transported.<a href="#section-3.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.6">
            If there are only two bstr fields in the target structure, this field is omitted.
            The field is an array of all bstr fields after the second.
            As an example, this would be an array of one element for the COSE_Sign1 structure containing the signature value.<a href="#section-3.3-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-3">The CDDL fragment that describes the above text is:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<div id="section-3.3-4">
<pre class="sourcecode lang-CDDL">
Countersign_structure = [
    context : "CounterSignature" / "CounterSignature0" /
              "CounterSignatureV2" / "CounterSignature0V2" /,
    body_protected : empty_or_serialized_map,
    ? sign_protected : empty_or_serialized_map,
    external_aad : bstr,
    payload : bstr,
    ? other_fields : [ + bstr ]
]
</pre><a href="#section-3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.3-5">How to compute a countersignature:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-6">
          <li id="section-3.3-6.1">Create a Countersign_structure and populate it with the appropriate fields.<a href="#section-3.3-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-6.2">Create the value ToBeSigned by encoding the Countersign_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 4</a>.<a href="#section-3.3-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-6.3">Call the signature creation algorithm passing in K (the key to sign with), alg (the algorithm to sign with), and ToBeSigned (the value to sign).<a href="#section-3.3-6.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-6.4">
            Place the resulting signature value in the correct location.
            This is the 'signature' field of the COSE_Countersignature structure.
            This is the value of the Countersignature0 attribute.<a href="#section-3.3-6.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-7">The steps for verifying a countersignature are:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-8">
          <li id="section-3.3-8.1">Create a Countersign_structure and populate it with the appropriate fields.<a href="#section-3.3-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-8.2">Create the value ToBeSigned by encoding the Countersign_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 4</a>.<a href="#section-3.3-8.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-8.3">Call the signature verification algorithm passing in K (the key to verify with), alg (the algorithm used sign with), ToBeSigned (the value to sign), and sig (the signature to be verified).<a href="#section-3.3-8.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-9">
  In addition to performing the signature verification, the application performs the appropriate checks to ensure that the key is correctly paired with the signing identity and that the signing identity is authorized before performing actions.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CBOR-Canonical">
<section id="section-4">
      <h2 id="name-cbor-encoding-restrictions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-cbor-encoding-restrictions" class="section-name selfRef">CBOR Encoding Restrictions</a>
      </h2>
<p id="section-4-1">
        In order to always regenerate the same byte string for the "to be signed" value, the deterministic encoding rules defined in <span><a href="https://tools.ietf.org/html/draft-ietf-cbor-7049bis-16#section-4.2" class="relref">Section 4.2</a> of [<a href="#I-D.ietf-cbor-7049bis" class="xref">I-D.ietf-cbor-7049bis</a>]</span>.
        These rules match the ones laid out in <span><a href="https://tools.ietf.org/html/draft-ietf-cose-rfc8152bis-struct-15#section-11" class="relref">Section 11</a> of [<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">
        The registries and registrations listed below were created during processing of RFC 8152 <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.
        The majority of the actions are to update the references to point to this document.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="cbor-tag-assignment">
<section id="section-5.1">
        <h3 id="name-cbor-tag-assignment">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cbor-tag-assignment" class="section-name selfRef">CBOR Tag Assignment</a>
        </h3>
<p id="section-5.1-1">
          IANA is requested to register a new tag for the CounterSignature type.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">Tag: TBD0<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">Data Item: COSE_Countersignature<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">Semantics: COSE standalone V2 countersignature<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">Reference: [[this document]]<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="cose-header-key-table">
<section id="section-5.2">
        <h3 id="name-cose-header-parameters-regi">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cose-header-parameters-regi" class="section-name selfRef">COSE Header Parameters Registry</a>
        </h3>
<p id="section-5.2-1">
          IANA created a registry titled "COSE Header Parameters" as part of processing <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
          IANA is requested to register the following new items in the registry. For these entries, the Value Registry column will be blank and the Reference column will be [[This Document]].<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span id="name-new-common-header-parameter"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-new-common-header-parameter" class="selfRef">New Common Header Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">counter signature version 2</td>
              <td class="text-left" rowspan="1" colspan="1">TBD10</td>
              <td class="text-left" rowspan="1" colspan="1">COSE_Countersignature / [+ COSE_Countersignature ]</td>
              <td class="text-left" rowspan="1" colspan="1">V2 countersignature attribute</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Countersignature0 version 2</td>
              <td class="text-left" rowspan="1" colspan="1">TBD11</td>
              <td class="text-left" rowspan="1" colspan="1">COSE_Countersignature0</td>
              <td class="text-left" rowspan="1" colspan="1">Abbreviated Counter signature vesion 2</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.2-4">
          IANA is requested to modify the Description field for "counter signature" and "CounterSignature0" to include the words "(Deprecated by [[This Document]]".<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
        There are a number of security considerations that need to be taken into account by implementers of this specification.
        While some considerations have been highlighted here, additional considerations may be found in the documents listed in the references.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Implementations need to protect the private key material for any individuals.  There are some cases that need to be highlighted on this issue.<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">Using the same key for two different algorithms can leak information about the key.  It is therefore recommended that keys be restricted to a single algorithm.<a href="#section-6-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.2">Use of 'direct' as a recipient algorithm combined with a second recipient algorithm exposes the direct key to the second recipient.<a href="#section-6-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.3">Several of the algorithms in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span> have limits on the number of times that a key can be used without leaking information about the key.<a href="#section-6-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-4">The use of ECDH and direct plus KDF (with no key wrap) will not directly lead to the private key being leaked; the one way function of the KDF will prevent that.  There is, however, a different issue that needs to be addressed.  Having two recipients requires that the CEK be shared between two recipients.  The second recipient therefore has a CEK that was derived from material that can be used for the weak proof of origin.  The second recipient could create a message using the same CEK and send it to the first recipient; the first recipient would, for either static-static ECDH or direct plus KDF, make an assumption that the CEK could be used for proof of origin even though it is from the wrong entity.  If the key wrap step is added, then no proof of origin is implied and this is not an issue.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
        
        Although it has been mentioned before, the use of a single key for multiple algorithms has been demonstrated in some cases to leak information about that key, provide the opportunity for attackers to forge integrity tags, or gain information about encrypted content. Binding a key to a single algorithm prevents these problems.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Key creators and key consumers are strongly encouraged not only to create new keys for each different algorithm, but to include that selection of algorithm in any distribution of key material and strictly enforce the matching of algorithms in the key structure to algorithms in the message structure. In addition to checking that algorithms are correct, the key form needs to be checked as well. Do not use an 'EC2' key where an 'OKP' key is expected.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">Before using a key for transmission, or before acting on information received, a trust decision on a key needs to be made.  Is the data or action something that the entity associated with the key has a right to see or a right to request? A number of factors are associated with this trust decision. Some of the ones that are highlighted here are:<a href="#section-6-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-8.1">What are the permissions associated with the key owner?<a href="#section-6-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-8.2">Is the cryptographic algorithm acceptable in the current context?<a href="#section-6-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-8.3">Have the restrictions associated with the key, such as algorithm or freshness, been checked and are they correct?<a href="#section-6-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-8.4">Is the request something that is reasonable, given the current state of the application?<a href="#section-6-8.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-8.5">Have any security considerations that are part of the message been enforced (as specified by the application or 'crit' header parameter)?<a href="#section-6-8.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-9">Analysis of the size of encrypted messages can provide information about the plaintext messages. This specification does not provide a uniform method for padding messages prior to encryption. An observer can distinguish between two different messages (for example, 'YES' and 'NO') based on the length for all of the content encryption algorithms that are defined in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>.  This means that it is up to the applications to specify how content padding is to be done to prevent or discourage such analysis.  (For example, the text strings could be defined as 'YES' and 'NO '.)<a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10">When either COSE_Encrypt and COSE_Mac is used and more than two parties share the key, data origin authentication is not provided. Any party that knows the message-authentication key can compute a valid authentication tag; therefore, the contents could originate from any one of the parties that share the key.<a href="#section-6-10" class="pilcrow">¶</a></p>
<p id="section-6-11">Countersignatures of COSE_Encrypt and COSE_Mac with short authentication tags do not provide the security properties associated with the same algorithm used in COSE_Sign. To provide 128-bit security against collision attacks, the tag length MUST be at least 256-bits. A countersignature of a COSE_Mac with AES-MAC 256/128 provides at most 64 bits of integrity protection. Similarly, a countersignature of a COSE_Encrypt with AES-CCM-16-64-128 provides at most 32 bits bits of integrity protection.<a href="#section-6-11" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-implementation-status">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-7-1">This section is to be removed before publishing as an RFC.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
        This section records the status of known implementations of the
        protocol defined by this specification at the time of posting of
        this Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>.  The description of implementations in this section is
        intended to assist the IETF in its decision processes in
        progressing drafts to RFCs.  Please note that the listing of any
        individual implementation here does not imply endorsement by the
        IETF.  Furthermore, no effort has been spent to verify the
        information presented here that was supplied by IETF contributors.
        This is not intended as, and must not be construed to be, a
        catalog of available implementations or their features.  Readers
        are advised to note that other implementations may exist.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
        According to <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>, "this will allow reviewers and working
        groups to assign due consideration to documents that have the
        benefit of running code, which may serve as evidence of valuable
        experimentation and feedback that have made the implemented
        protocols more mature.  It is up to the individual working groups
        to use this information as they see fit".<a href="#section-7-3" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-authors-versions">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-authors-versions" class="section-name selfRef">Author's Versions</a>
        </h3>
<p id="section-7.1-1">
          There are three different implementations that have been created by the author of the document both to create the examples that are included in the document and to validate the structures and methodology used in the design of COSE.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">Implementation Location: https://github.com/cose-wg<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.2">Primary Maintainer: Jim Schaad<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.3">
              Languages:
              There are three different languages that are currently supported:  Java and C#.<a href="#section-7.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.4">
              Cryptography: The Java and C# libraries use Bouncy Castle to provide the required cryptography.<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.5">
            Coverage:
            Both implementations can produce and consume both the old and new countersignatures.<a href="#section-7.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.6">
              Testing:
              All of the examples in the example library are generated by the C# library and then validated using the Java and C libraries.
              Both libraries have tests to allow for the creating of the same messages that are in the example library followed by validating them.
              These are not compared against the example library.
              The Java and C# libraries have unit testing included.
              Not all of the <span class="bcp14">MUST</span> statements in the document have been implemented as part of the libraries.
              One such statement is the requirement that unique labels be present.<a href="#section-7.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.7">Licensing: Revised BSD License<a href="#section-7.1-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-7.2">
        <h3 id="name-cose-testing-library">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-cose-testing-library" class="section-name selfRef">COSE Testing Library</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.2-1.1">Implementation Location: https://github.com/cose-wg/Examples<a href="#section-7.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.2">Primary Maintainer: Jim Schaad<a href="#section-7.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.3">
              Description: A set of tests for the COSE library is provided as part of the implementation effort.
              Both success and fail tests have been provided.
              All of the examples in this document are part of this example set.<a href="#section-7.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.4">
              Coverage:  An attempt has been made to have test cases for every message type and algorithm in the document.
              Currently examples dealing with countersignatures, and ECDH with Curve25519 and Goldilocks are missing.<a href="#section-7.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.5">Licensing: Public Domain<a href="#section-7.2-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-7049bis">[I-D.ietf-cbor-7049bis]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-7049bis-16</span>, <time datetime="2020-09-30" class="refDate">30 September 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-7049bis-16.txt">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-7049bis-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12.txt">https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="STD90">[STD90]</dt>
        <dd><div class="refInstance" id="RFC8259">
            <span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/std90">https://www.rfc-editor.org/info/std90</a>&gt;</span>
</dd>
<dd class="break"></dd><dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4998">[RFC4998]</dt>
        <dd>
<span class="refAuthor">Gondrom, T.</span>, <span class="refAuthor">Brandner, R.</span>, and <span class="refAuthor">U. Pordesch</span>, <span class="refTitle">"Evidence Record Syntax (ERS)"</span>, <span class="seriesInfo">RFC 4998</span>, <span class="seriesInfo">DOI 10.17487/RFC4998</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4998">https://www.rfc-editor.org/info/rfc4998</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-03</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-03.txt">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-struct-15.txt">https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="examples">
<section id="section-appendix.a">
      <h2 id="name-examples">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-appendix.a-1">This appendix includes a set of examples that show the different features and message types that have been defined in this document.  To make the examples easier to read, they are presented using the extended CBOR diagnostic notation (defined in <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>) rather than as a binary dump.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">The examples are presented using the CBOR's diagnostic notation.  A Ruby-based tool exists that can convert between the diagnostic notation and binary.  This tool can be installed with the command line:<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<div id="section-appendix.a-3">
<pre class="sourcecode">gem install cbor-diag
</pre><a href="#section-appendix.a-3" class="pilcrow">¶</a>
</div>
<p id="section-appendix.a-4">The diagnostic notation can be converted into binary files using the following command line:<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<div id="section-appendix.a-5">
<pre class="sourcecode">diag2cbor.rb &lt; inputfile &gt; outputfile
</pre><a href="#section-appendix.a-5" class="pilcrow">¶</a>
</div>
<p id="section-appendix.a-6">The examples can be extracted from the XML version of this document via an XPath expression as all of the sourcecode is tagged with the attribute type='CBORdiag'.  (Depending on the XPath evaluator one is using, it may be necessary to deal with &amp;gt; as an entity.)<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<div id="section-appendix.a-7">
<pre class="sourcecode lang-XPATH">//sourcecode[@type='CDDL']/text()</pre><a href="#section-appendix.a-7" class="pilcrow">¶</a>
</div>
<section id="section-a.1">
        <h2 id="name-use-of-early-code-points">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-use-of-early-code-points" class="section-name selfRef">Use of Early Code Points</a>
        </h2>
<p id="section-a.1-1">This section is to be removed before publishing as an RFC.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<p id="section-a.1-2">The examples in this Appendix use code points proposed for early allocation by IANA.  When IANA makes the allocation, these examples will be updated as needed.<a href="#section-a.1-2" class="pilcrow">¶</a></p>
</section>
<div id="SignedExamples">
<section id="section-a.2">
        <h2 id="name-examples-of-signed-messages">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-examples-of-signed-messages" class="section-name selfRef">Examples of Signed Messages</a>
        </h2>
<div id="Appendix_A_1_1">
<section id="section-a.2.1">
          <h3 id="name-countersignature">
<a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-countersignature" class="section-name selfRef">Countersignature</a>
          </h3>
<p id="section-a.2.1-1">This example uses the following:<a href="#section-a.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.2.1-2.1">Signature Algorithm: ECDSA w/ SHA-256, Curve P-256<a href="#section-a.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.2.1-2.2">The same header parameters are used for both the signature and the countersignature.<a href="#section-a.2.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.2.1-3">Size of binary file is 180 bytes<a href="#section-a.2.1-3" class="pilcrow">¶</a></p>
<div id="section-a.2.1-4">
<pre class="sourcecode lang-CBORdiag">
98(
  [
    / protected / h'',
    / unprotected / {
      / countersign / 11:[
        / protected  h'a10126' / &lt;&lt; {
            / alg / 1:-7 / ECDSA 256 /
          } &gt;&gt;,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'5ac05e289d5d0e1b0a7f048a5d2b643813ded50bc9e4
9220f4f7278f85f19d4a77d655c9d3b51e805a74b099e1e085aacd97fc29d72f887e
8802bb6650cceb2c'
      ]
    },
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected h'a10126' / &lt;&lt; {
            / alg / 1:-7 / ECDSA 256 /
          } &gt;&gt;,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ]
    ]
  ]
)

</pre><a href="#section-a.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Signed1Examples">
<section id="section-a.3">
        <h2 id="name-examples-of-signed1-message">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-examples-of-signed1-message" class="section-name selfRef">Examples of Signed1 Messages</a>
        </h2>
<div id="Appendix_B_2_3">
<section id="section-a.3.1">
          <h3 id="name-countersignature-2">
<a href="#section-a.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-countersignature-2" class="section-name selfRef">Countersignature</a>
          </h3>
<p id="section-a.3.1-1">This example uses the following:<a href="#section-a.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.3.1-2.1">Signature Algorithm: ECDSA w/ SHA-256, Curve P-256<a href="#section-a.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.3.1-2.2">Countersignature Algorithm: ECDSA w/ SHA-512, Curve P-521<a href="#section-a.3.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.3.1-3">Size of binary file is 275 bytes<a href="#section-a.3.1-3" class="pilcrow">¶</a></p>
<div id="section-a.3.1-4">
<pre class="sourcecode lang-CBORdiag">
18(
  [
    / protected h'A201260300' / &lt;&lt; {
      / alg / 1:-7, / ECDSA 256 /
      / ctyp / 3:0
    } &gt;&gt;,
    / unprotected / {
      / kid / 4: "11",
      / countersign / 11: [
        / protected h'A1013823' / &lt;&lt; {
          / alg / 1:-36 / ECDSA 512 /
        } &gt;&gt;,
        / unprotected / {
          / kid / 4: "bilbo.baggins@hobbiton.example"
        },
        / signature / h'01B1291B0E60A79C459A4A9184A0D393E034B34AF069
A1CCA34F5A913AFFFF698002295FA9F8FCBFB6FDFF59132FC0C406E98754A98F1FBF
E81C03095F481856BC470170227206FA5BEE3C0431C56A66824E7AAF692985952E31
271434B2BA2E47A335C658B5E995AEB5D63CF2D0CED367D3E4CC8FFFD53B70D115BA
A9E86961FBD1A5CF'
      ]
    },
    / payload / 'This is the content.',
    / signature / h'BB587D6B15F47BFD54D2CBFCECEF75451E92B08A514BD439
FA3AA65C6AC92DF0D7328C4A47529B32ADD3DD1B4E940071C021E9A8F2641F1D8E3B
053DDD65AE52'
  ]
)
</pre><a href="#section-a.3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="EnvelopedExamples">
<section id="section-a.4">
        <h2 id="name-examples-of-enveloped-messa">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-examples-of-enveloped-messa" class="section-name selfRef">Examples of Enveloped Messages</a>
        </h2>
<div id="Appendix_A_2_1">
<section id="section-a.4.1">
          <h3 id="name-countersignature-on-encrypt">
<a href="#section-a.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-countersignature-on-encrypt" class="section-name selfRef">Countersignature on Encrypted Content</a>
          </h3>
<p id="section-a.4.1-1">This example uses the following:<a href="#section-a.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.4.1-2.1">CEK: AES-GCM w/ 128-bit key<a href="#section-a.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.4.1-2.2">Recipient class: ECDH Ephemeral-Static, Curve P-256<a href="#section-a.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.4.1-2.3">Countersignature Algorithm: ECDSA w/ SHA-512, Curve P-521<a href="#section-a.4.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.4.1-3">Size of binary file is 326 bytes<a href="#section-a.4.1-3" class="pilcrow">¶</a></p>
<div id="section-a.4.1-4">
<pre class="sourcecode lang-CBORdiag">
96(
  [
    / protected h'a10101' / &lt;&lt; {
        / alg / 1:1 / AES-GCM 128 /
      } &gt;&gt;,
    / unprotected / {
      / iv / 5:h'c9cf4df2fe6c632bf7886413',
      / countersign / 11:[
        / protected h'a1013823' / &lt;&lt; {
            / alg / 1:-36 / ES512 /
          } &gt;&gt; ,
        / unprotected / {
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / signature / h'00929663c8789bb28177ae28467e66377da12302d7f9
594d2999afa5dfa531294f8896f2b6cdf1740014f4c7f1a358e3a6cf57f4ed6fb02f
cf8f7aa989f5dfd07f0700a3a7d8f3c604ba70fa9411bd10c2591b483e1d2c31de00
3183e434d8fba18f17a4c7e3dfa003ac1cf3d30d44d2533c4989d3ac38c38b71481c
c3430c9d65e7ddff'
      ]
    },
    / ciphertext / h'7adbe2709ca818fb415f1e5df66f4e1a51053ba6d65a1a0
c52a357da7a644b8070a151b0',
    / recipients / [
      [
        / protected h'a1013818' / &lt;&lt; {
            / alg / 1:-25 / ECDH-ES + HKDF-256 /
          } &gt;&gt; ,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:1,
            / x / -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbf
bf054e1c7b4d91d6280',
            / y / -3:true
          },
          / kid / 4:'meriadoc.brandybuck@buckland.example'
        },
        / ciphertext / h''
      ]
    ]
  ]
)

</pre><a href="#section-a.4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="EncryptExamples">
<section id="section-a.5">
        <h2 id="name-examples-of-encrypted-messa">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-examples-of-encrypted-messa" class="section-name selfRef">Examples of Encrypted Messages</a>
        </h2>
<div id="Appendix_B_4_3">
<section id="section-a.5.1">
          <h3 id="name-countersignature-on-encrypte">
<a href="#section-a.5.1" class="section-number selfRef">A.5.1. </a><a href="#name-countersignature-on-encrypte" class="section-name selfRef">Countersignature on Encrypted Content</a>
          </h3>
<p id="section-a.5.1-1">This example uses the following:<a href="#section-a.5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.5.1-2.1">CEK: AES-GCM w/ 128-bit key<a href="#section-a.5.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.5.1-2.2">Countersignature algorithm: EdDSA with Curve Ed25519<a href="#section-a.5.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.5.1-3">Size of binary file is 136 bytes<a href="#section-a.5.1-3" class="pilcrow">¶</a></p>
<div id="section-a.5.1-4">
<pre class="sourcecode lang-CBORdiag">
16(
  [
    / protected h'A10101' / &lt;&lt; {
      / alg / 1:1 / AES-GCM 128 /
    } &gt;&gt;,
    / unprotected / {
      / iv / 5: h'02D1F7E6F26C43D4868D87CE',
      / countersign / 11: [
        / protected h'A10127' / &lt;&lt; {
          / alg / 1:-8 / EdDSA with Ed25519 /
        } &gt;&gt;,
        / unprotected / {
          / kid / 4: '11'
        },
        / signature / h'E10439154CC75C7A3A5391491F88651E0292FD0FE0E0
2CF740547EAF6677B4A4040B8ECA16DB592881262F77B14C1A086C02268B17171CA1
6BE4B8595F8C0A08'
      ]
    },
    / ciphertext / h'60973A94BB2898009EE52ECFD9AB1DD25867374B162E2C0
3568B41F57C3CC16F9166250A'
  ]
)
</pre><a href="#section-a.5.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="MacExamples">
<section id="section-a.6">
        <h2 id="name-examples-of-maced-messages">
<a href="#section-a.6" class="section-number selfRef">A.6. </a><a href="#name-examples-of-maced-messages" class="section-name selfRef">Examples of MACed Messages</a>
        </h2>
<div id="Appendix_B_5_3">
<section id="section-a.6.1">
          <h3 id="name-countersignature-on-mac-con">
<a href="#section-a.6.1" class="section-number selfRef">A.6.1. </a><a href="#name-countersignature-on-mac-con" class="section-name selfRef">Countersignature on MAC Content</a>
          </h3>
<p id="section-a.6.1-1">This example uses the following:<a href="#section-a.6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.6.1-2.1">MAC algorithm: HMAC/SHA-256 with 256-bit key<a href="#section-a.6.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.6.1-2.2">Countersignature algorithm: EdDSA with Curve Ed25519<a href="#section-a.6.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.6.1-3">Size of binary file is 159 bytes<a href="#section-a.6.1-3" class="pilcrow">¶</a></p>
<div id="section-a.6.1-4">
<pre class="sourcecode lang-CBORdiag">
97(
  [
    / protected h'A10105' / &lt;&lt; {
      / alg / 1:5 / HS256 /
    } &gt;&gt;,
    / unprotected / {
      / countersign / 11: [
        / protected h'A10127' / &lt;&lt; {
          / alg / 1:-8 / EdDSA /
        } &gt;&gt;,
        / unprotected / {
          / kid / 4: '11'
        },
        / signature / h'602566F4A311DC860740D2DF54D4864555E85BC036EA
5A6CF7905B96E499C5F66B01C4997F6A20C37C37543ADEA1D705347D38A5B13594B2
9583DD741F455101'
      ]
    },
    / payload / 'This is the content.',
    / tag / h'2BDCC89F058216B8A208DDC6D8B54AA91F48BD63484986565105C9
AD5A6682F6',
    / recipients / [
      [
        / protected / h'',
        / unprotected / {
          / alg / 1: -6, / direct /
          / kid / 4: 'our-secret'
        },
        / ciphertext / h''
      ]
    ]
  ]
)
</pre><a href="#section-a.6.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Mac0Examples">
<section id="section-a.7">
        <h2 id="name-examples-of-mac0-messages">
<a href="#section-a.7" class="section-number selfRef">A.7. </a><a href="#name-examples-of-mac0-messages" class="section-name selfRef">Examples of MAC0 Messages</a>
        </h2>
<div id="Appendix_B_6_3">
<section id="section-a.7.1">
          <h3 id="name-countersignature-on-mac0-co">
<a href="#section-a.7.1" class="section-number selfRef">A.7.1. </a><a href="#name-countersignature-on-mac0-co" class="section-name selfRef">Countersignature on MAC0 Content</a>
          </h3>
<p id="section-a.7.1-1">This example uses the following:<a href="#section-a.7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.7.1-2.1">MAC algorithm: HMAC/SHA-256 with 256-bit key<a href="#section-a.7.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.7.1-2.2">Countersignature algorithm: EdDSA with Curve Ed25519<a href="#section-a.7.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.7.1-3">Size of binary file is 159 bytes<a href="#section-a.7.1-3" class="pilcrow">¶</a></p>
<div id="section-a.7.1-4">
<pre class="sourcecode lang-CBORdiag">
17(
  [
    / protected h'A10105' / &lt;&lt; {
      / alg / 1:5 / HS256 /
    } &gt;&gt;,
    / unprotected / {
      / countersign / 11: [
        / protected h'A10127' / &lt;&lt; {
          / alg / 1:-8 / EdDSA /
        } &gt;&gt;,
        / unprotected / {
          / kid / 4: '11'
        },
        / signature / h'968A315DF6B4F26362E11F4CFD2F2F4E76232F39657B
F1598837FF9332CDDD7581E248116549451F81EF823DA5974F885B681D3D6E38FC41
42D8F8E9E7DC8F0D'
      ]
    },
    / payload / 'This is the content.',
    / tag / h'A1A848D3471F9D61EE49018D244C824772F223AD4F935293F1789F
C3A08D8C58'
  ]
)
</pre><a href="#section-a.7.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">This document is a product of the COSE working group of the IETF.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The initial version of the specification was based to some degree on the outputs of the JOSE and S/MIME working groups.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">Jim Schaad passed on 3 October 2020.  This document is primarily his work.  Russ Housley served as the document editor after Jim's untimely death, mostly helping with the approval and publication processes.  Jim deserves all credit for the technical content.<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<p id="section-appendix.b-4">Jim Schaad and Jonathan Hammell provided the examples in the Appendix.<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<p id="section-appendix.b-5">{{{ RFC EDITOR: Please remove Russ Housley as an author of this document at publication.  Jim Schaad should be listed as the sole author. }}}<a href="#section-appendix.b-5" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jim Schaad</span></div>
<div dir="auto" class="left"><span class="org">August Cellars</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@augustcellars.com" class="email">ietf@augustcellars.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Russ Housley (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Vigil Security, LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:housley@vigilsec.com" class="email">housley@vigilsec.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
